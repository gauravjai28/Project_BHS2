---
- name: Ansible file
  hosts: webservers
  gather_facts: no
  become: yes
  tasks:
    - name: Install update on ubuntu
      shell:
        "apt install update -y"
    - name: Install docker
      delay: 30
      shell:
        "apt install docker -y"
    - name: Install docker-compose
      shell:
        "apt install docker-compose -y"
    - name: copy the file to the server
      copy:
        src: /var/lib/jenkins/jobs/Ansible_project/workspace/inputFile/index.html
        dest: /opt/inputFile
        
    - name: copy the file
      copy:
        src: /var/lib/jenkins/jobs/Ansible_project/workspace/docker_c/
        dest: /opt/docker_c
        
    - name: run shell cmd
      shell:
        "chmod +x /opt/docker_c/docker-compose.yml" 
             
    - name: run shell cmd
      async: 30
      poll: 0
      shell:
        "cd /opt/docker_c && docker-compose up"
